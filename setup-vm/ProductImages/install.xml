<modification>
	<name>Product Image In Order Confirmation Email</name>
    <version>2.*</version>
    <link>http://www.openwebsofttech.com</link>
    <author>www.openwebsofttech.com</author>
    <code>ordprdimg_009</code> 	
	
	<file path="catalog/model/checkout/order.php">
        <operation>
            <search position="before"><![CDATA[$data['products'][] = array(]]></search>
			<add position="before"><![CDATA[
			$data['ordprdimg_status'] = $this->config->get('ordprdimg_status');
			if($this->config->get('ordprdimg_status')) { 
				$ordprdimg_image_col_name = $this->config->get('ordprdimg_image_col_name');
				$data['ordprdimg_image_col_name'] = $ordprdimg_image_col_name[(int)$order_info['language_id']];
				$product_img_query = $this->db->query("SELECT image FROM " . DB_PREFIX . "product WHERE product_id = '" . (int)$product['product_id'] . "'");
				$this->load->model('tool/image');
				if ($product_img_query->row['image']) {
					$product_img = $this->model_tool_image->resize($product_img_query->row['image'], $this->config->get('ordprdimg_img_w'), $this->config->get('ordprdimg_img_h'));
				} else {
					$product_img = $this->model_tool_image->resize('placeholder.png', $this->config->get('ordprdimg_img_w'), $this->config->get('ordprdimg_img_h'));
				}
			}
			]]></add> 
        </operation>
		<operation>
            <search position="after"><![CDATA[$data['products'][] = array(]]></search>
			<add position="after"><![CDATA['product_img'     => $product_img,]]></add> 
        </operation>
  	</file>
	<file path="catalog/view/theme/*/template/mail/order.tpl">
        <operation>
            <search position="before"><![CDATA[<td style="font-size: 12px; border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; background-color: #EFEFEF; font-weight: bold; text-align: left; padding: 7px; color: #222222;"><?php echo $text_product; ?></td>]]></search>
			<add position="before"><![CDATA[<?php if($ordprdimg_status) { ?> <td style="font-size: 12px; border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; background-color: #EFEFEF; font-weight: bold; text-align: left; padding: 7px; color: #222222;"><?php echo $ordprdimg_image_col_name; ?></td> <?php } ?>]]></add> 
        </operation>
		<operation>
            <search position="before"><![CDATA[<td style="font-size: 12px;	border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; text-align: left; padding: 7px;"><?php echo $product['name']; ?>]]></search>
			<add position="before"><![CDATA[<?php if($ordprdimg_status) { ?> <td style="font-size: 12px;	border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; text-align: left; padding: 7px;"><img src="<?php echo $product['product_img']; ?>"></td> <?php } ?>]]></add> 
        </operation>
		<operation>
            <search position="replace"><![CDATA[colspan="4"]]></search>
			<add position="replace"><![CDATA[<?php if($ordprdimg_status) { ?> colspan="5" <?php } else { ?> colspan="4" <?php } ?>]]></add> 
        </operation>
  	</file>
</modification>